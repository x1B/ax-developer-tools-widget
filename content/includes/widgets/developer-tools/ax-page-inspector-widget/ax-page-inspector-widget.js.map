{"version":3,"sources":["ax-page-inspector-widget.jsx"],"names":[],"mappings":"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","file":"ax-page-inspector-widget.js","sourcesContent":["import React from 'react';\nimport patterns from 'laxar-patterns';\n\nimport wireflow from 'wireflow';\n\nimport { types, graph, layout } from './graph-helpers';\n\nconst {\n  selection: {\n    SelectionStore\n  },\n  history: {\n    actions: { CreateCheckpoint },\n    HistoryStore\n  },\n  layout: {\n     actions: { AutoLayout },\n     LayoutStore\n  },\n  graph: {\n    GraphStore\n  },\n  settings: {\n    actions: { ChangeMode },\n    model: { Settings, READ_ONLY, READ_WRITE },\n    SettingsStore\n  },\n  Dispatcher,\n  components: { Graph }\n} = wireflow;\n\nfunction create( context, eventBus, reactRender ) {\n\n   var domAvailable = false;\n   var resourceAvailable = false;\n   var visible = false;\n   var hideIrrelevantWidgets = true;\n\n   patterns.resources.handlerFor( context )\n      .registerResourceFromFeature( 'pageInfo', {\n         onUpdateReplace: () => {\n            resourceAvailable = true;\n            update();\n         }\n      } );\n\n   eventBus.subscribe( 'didChangeAreaVisibility.' + context.widget.area, event => {\n      if( !visible && event.visible ) {\n         visible = true;\n         update();\n      }\n   } );\n\n   function updateHideIrrelevantWidgets( event ) {\n      hideIrrelevantWidgets = event.target.checked;\n      update();\n   }\n\n   function renderEmpty() {\n      reactRender( <h3>Waiting for data</h3> );\n   }\n\n   let dispatcher;\n   function update() {\n      if( !visible || !domAvailable || !resourceAvailable ) {\n         return;\n      }\n\n      const pageInfo = context.resources.pageInfo;\n      const pageGraph = graph( pageInfo, hideIrrelevantWidgets );\n\n      const pageTyeps = types();\n      dispatcher = new Dispatcher( render );\n      new HistoryStore( dispatcher );\n      const graphStore = new GraphStore( dispatcher, pageGraph, pageTyeps );\n      const layoutStore = new LayoutStore( dispatcher, graphStore );\n      const settingsStore = new SettingsStore( dispatcher, Settings({ mode: READ_ONLY }) );\n      const selectionStore = new SelectionStore( dispatcher, layoutStore, graphStore );\n\n      function render() {\n         reactRender(\n            <div className='page-inspector-row'>\n               <div className='page-inspector-settings'>\n                  <label>\n                     <input type='checkbox'\n                        checked={hideIrrelevantWidgets}\n                        onChange={updateHideIrrelevantWidgets}/>\n                     Hide simple widgets\n                  </label>\n               </div>\n               <Graph className={'nbe-theme-fusebox-app'}\n                      types={graphStore.types}\n                      model={graphStore.graph}\n                      layout={layoutStore.layout}\n                      measurements={layoutStore.measurements}\n                      settings={settingsStore.settings}\n                      selection={selectionStore.selection}\n                      eventHandler={dispatcher.dispatch} />\n            </div>\n         );\n      }\n   }\n\n   return { onDomAvailable: () => {\n      domAvailable = true;\n      update();\n   } };\n}\n\nexport default {\n   name: 'ax-page-inspector-widget',\n   injections: [ 'axContext', 'axEventBus', 'axReactRender' ],\n   create\n};\n"]}